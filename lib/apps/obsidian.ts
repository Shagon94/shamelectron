import { findPattern } from "@/lib/findPattern";
import { FixedStatus, type AppMeta } from "../../types";

export const Obsidian: AppMeta = {
  // prettier-ignore
  icon: "data:image/svg+xml;charset=utf-8,%3Csvg%20id%3D%22custom-logo%22%20width%3D%22512%22%20height%3D%22512%22%20viewBox%3D%220%200%20512%20512%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20style%3D%22height%3A100%25%3Bwidth%3A100%25%3B%22%3E%0A%20%20%3Cdefs%3E%0A%20%20%20%20%3CradialGradient%20id%3D%22b%22%20cx%3D%220%22%20cy%3D%220%22%20r%3D%221%22%20gradientUnits%3D%22userSpaceOnUse%22%20gradientTransform%3D%22matrix(-48%20-185%20123%20-32%20179%20429.7)%22%3E%0A%20%20%20%20%20%20%3Cstop%20stop-color%3D%22%23fff%22%20stop-opacity%3D%22.4%22%2F%3E%0A%20%20%20%20%20%20%3Cstop%20offset%3D%221%22%20stop-opacity%3D%22.1%22%2F%3E%0A%20%20%20%20%3C%2FradialGradient%3E%0A%20%20%20%20%3CradialGradient%20id%3D%22c%22%20cx%3D%220%22%20cy%3D%220%22%20r%3D%221%22%20gradientUnits%3D%22userSpaceOnUse%22%20gradientTransform%3D%22matrix(41%20-310%20229%2030%20341.6%20351.3)%22%3E%0A%20%20%20%20%20%20%3Cstop%20stop-color%3D%22%23fff%22%20stop-opacity%3D%22.6%22%2F%3E%0A%20%20%20%20%20%20%3Cstop%20offset%3D%221%22%20stop-color%3D%22%23fff%22%20stop-opacity%3D%22.1%22%2F%3E%0A%20%20%20%20%3C%2FradialGradient%3E%0A%20%20%20%20%3CradialGradient%20id%3D%22d%22%20cx%3D%220%22%20cy%3D%220%22%20r%3D%221%22%20gradientUnits%3D%22userSpaceOnUse%22%20gradientTransform%3D%22matrix(57%20-261%20178%2039%20190.5%20296.3)%22%3E%0A%20%20%20%20%20%20%3Cstop%20stop-color%3D%22%23fff%22%20stop-opacity%3D%22.8%22%2F%3E%0A%20%20%20%20%20%20%3Cstop%20offset%3D%221%22%20stop-color%3D%22%23fff%22%20stop-opacity%3D%22.4%22%2F%3E%0A%20%20%20%20%3C%2FradialGradient%3E%0A%20%20%20%20%3CradialGradient%20id%3D%22e%22%20cx%3D%220%22%20cy%3D%220%22%20r%3D%221%22%20gradientUnits%3D%22userSpaceOnUse%22%20gradientTransform%3D%22matrix(-79%20-133%20153%20-90%20321.4%20464.2)%22%3E%0A%20%20%20%20%20%20%3Cstop%20stop-color%3D%22%23fff%22%20stop-opacity%3D%22.3%22%2F%3E%0A%20%20%20%20%20%20%3Cstop%20offset%3D%221%22%20stop-opacity%3D%22.3%22%2F%3E%0A%20%20%20%20%3C%2FradialGradient%3E%0A%20%20%20%20%3CradialGradient%20id%3D%22f%22%20cx%3D%220%22%20cy%3D%220%22%20r%3D%221%22%20gradientUnits%3D%22userSpaceOnUse%22%20gradientTransform%3D%22matrix(-29%20136%20-92%20-20%20300.7%20149.9)%22%3E%0A%20%20%20%20%20%20%3Cstop%20stop-color%3D%22%23fff%22%20stop-opacity%3D%220%22%2F%3E%0A%20%20%20%20%20%20%3Cstop%20offset%3D%221%22%20stop-color%3D%22%23fff%22%20stop-opacity%3D%22.2%22%2F%3E%0A%20%20%20%20%3C%2FradialGradient%3E%0A%20%20%20%20%3CradialGradient%20id%3D%22g%22%20cx%3D%220%22%20cy%3D%220%22%20r%3D%221%22%20gradientUnits%3D%22userSpaceOnUse%22%20gradientTransform%3D%22matrix(72%2073%20-155%20153%20137.8%20225.2)%22%3E%0A%20%20%20%20%20%20%3Cstop%20stop-color%3D%22%23fff%22%20stop-opacity%3D%22.2%22%2F%3E%0A%20%20%20%20%20%20%3Cstop%20offset%3D%221%22%20stop-color%3D%22%23fff%22%20stop-opacity%3D%22.4%22%2F%3E%0A%20%20%20%20%3C%2FradialGradient%3E%0A%20%20%20%20%3CradialGradient%20id%3D%22h%22%20cx%3D%220%22%20cy%3D%220%22%20r%3D%221%22%20gradientUnits%3D%22userSpaceOnUse%22%20gradientTransform%3D%22matrix(20%20118%20-251%2043%20215.1%20273.7)%22%3E%0A%20%20%20%20%20%20%3Cstop%20stop-color%3D%22%23fff%22%20stop-opacity%3D%22.1%22%2F%3E%0A%20%20%20%20%20%20%3Cstop%20offset%3D%221%22%20stop-color%3D%22%23fff%22%20stop-opacity%3D%22.3%22%2F%3E%0A%20%20%20%20%3C%2FradialGradient%3E%0A%20%20%20%20%3CradialGradient%20id%3D%22i%22%20cx%3D%220%22%20cy%3D%220%22%20r%3D%221%22%20gradientUnits%3D%22userSpaceOnUse%22%20gradientTransform%3D%22matrix(-162%20-85%20268%20-510%20374.4%20371.7)%22%3E%0A%20%20%20%20%20%20%3Cstop%20stop-color%3D%22%23fff%22%20stop-opacity%3D%22.2%22%2F%3E%0A%20%20%20%20%20%20%3Cstop%20offset%3D%22.5%22%20stop-color%3D%22%23fff%22%20stop-opacity%3D%22.2%22%2F%3E%0A%20%20%20%20%20%20%3Cstop%20offset%3D%221%22%20stop-color%3D%22%23fff%22%20stop-opacity%3D%22.3%22%2F%3E%0A%20%20%20%20%3C%2FradialGradient%3E%0A%20%20%20%20%3Cfilter%20id%3D%22a%22%20x%3D%2280.1%22%20y%3D%2237%22%20width%3D%22351.1%22%20height%3D%22443.2%22%20filterUnits%3D%22userSpaceOnUse%22%20color-interpolation-filters%3D%22sRGB%22%3E%0A%20%20%20%20%20%20%3CfeFlood%20flood-opacity%3D%220%22%20result%3D%22BackgroundImageFix%22%2F%3E%0A%20%20%20%20%20%20%3CfeBlend%20in%3D%22SourceGraphic%22%20in2%3D%22BackgroundImageFix%22%20result%3D%22shape%22%2F%3E%0A%20%20%20%20%20%20%3CfeGaussianBlur%20stdDeviation%3D%226.5%22%20result%3D%22effect1_foregroundBlur_744_9191%22%2F%3E%0A%20%20%20%20%3C%2Ffilter%3E%0A%20%20%3C%2Fdefs%3E%0A%20%20%3Crect%20id%3D%22logo-bg%22%20fill%3D%22%23262626%22%20width%3D%22512%22%20height%3D%22512%22%20rx%3D%22100%22%2F%3E%0A%20%20%3Cg%20filter%3D%22url(%23a)%22%3E%0A%20%20%20%20%3Cpath%20d%3D%22M359.2%20437.5c-2.6%2019-21.3%2033.9-40%2028.7-26.5-7.2-57.2-18.6-84.8-20.7l-42.4-3.2a28%2028%200%200%201-18-8.3l-73-74.8a27.7%2027.7%200%200%201-5.4-30.7s45-98.6%2046.8-103.7c1.6-5.1%207.8-49.9%2011.4-73.9a28%2028%200%200%201%209-16.5L249%2057.2a28%2028%200%200%201%2040.6%203.4l72.6%2091.6a29.5%2029.5%200%200%201%206.2%2018.3c0%2017.3%201.5%2053%2011.2%2076a301.3%20301.3%200%200%200%2035.6%2058.2%2014%2014%200%200%201%201%2015.6c-6.3%2010.7-18.9%2031.3-36.6%2057.6a142.2%20142.2%200%200%200-20.5%2059.6Z%22%20fill%3D%22%23000%22%20fill-opacity%3D%22.3%22%2F%3E%0A%20%20%3C%2Fg%3E%0A%20%20%3Cpath%20id%3D%22arrow%22%20d%3D%22M359.9%20434.3c-2.6%2019.1-21.3%2034-40%2028.9-26.4-7.3-57-18.7-84.7-20.8l-42.3-3.2a27.9%2027.9%200%200%201-18-8.4l-73-75a27.9%2027.9%200%200%201-5.4-31s45.1-99%2046.8-104.2c1.7-5.1%207.8-50%2011.4-74.2a28%2028%200%200%201%209-16.6l86.2-77.5a28%2028%200%200%201%2040.6%203.5l72.5%2092a29.7%2029.7%200%200%201%206.2%2018.3c0%2017.4%201.5%2053.2%2011.1%2076.3a303%20303%200%200%200%2035.6%2058.5%2014%2014%200%200%201%201.1%2015.7c-6.4%2010.8-18.9%2031.4-36.7%2057.9a143.3%20143.3%200%200%200-20.4%2059.8Z%22%20fill%3D%22%236C31E3%22%2F%3E%0A%20%20%3Cpath%20d%3D%22M182.7%20436.4c33.9-68.7%2033-118%2018.5-153-13.2-32.4-37.9-52.8-57.3-65.5-.4%201.9-1%203.7-1.8%205.4L96.5%20324.8a27.9%2027.9%200%200%200%205.5%2031l72.9%2075c2.3%202.3%205%204.2%207.8%205.6Z%22%20fill%3D%22url(%23b)%22%2F%3E%0A%20%20%3Cpath%20d%3D%22M274.9%20297c9.1.9%2018%202.9%2026.8%206.1%2027.8%2010.4%2053.1%2033.8%2074%2078.9%201.5-2.6%203-5.1%204.6-7.5a1222%201222%200%200%200%2036.7-57.9%2014%2014%200%200%200-1-15.7%20303%20303%200%200%201-35.7-58.5c-9.6-23-11-58.9-11.1-76.3%200-6.6-2.1-13.1-6.2-18.3l-72.5-92-1.2-1.5c5.3%2017.5%205%2031.5%201.7%2044.2-3%2011.8-8.6%2022.5-14.5%2033.8-2%203.8-4%207.7-5.9%2011.7a140%20140%200%200%200-15.8%2058c-1%2024.2%203.9%2054.5%2020%2095Z%22%20fill%3D%22url(%23c)%22%2F%3E%0A%20%20%3Cpath%20d%3D%22M274.8%20297c-16.1-40.5-21-70.8-20-95%201-24%208-42%2015.8-58l6-11.7c5.8-11.3%2011.3-22%2014.4-33.8a78.5%2078.5%200%200%200-1.7-44.2%2028%2028%200%200%200-39.4-2l-86.2%2077.5a28%2028%200%200%200-9%2016.6L144.2%20216c0%20.7-.2%201.3-.3%202%2019.4%2012.6%2044%2033%2057.3%2065.3%202.6%206.4%204.8%2013.1%206.4%2020.4a200%20200%200%200%201%2067.2-6.8Z%22%20fill%3D%22url(%23d)%22%2F%3E%0A%20%20%3Cpath%20d%3D%22M320%20463.2c18.6%205.1%2037.3-9.8%2039.9-29a153%20153%200%200%201%2015.9-52.2c-21-45.1-46.3-68.5-74-78.9-29.5-11-61.6-7.3-94.2.6%207.3%2033.1%203%2076.4-24.8%20132.7%203.1%201.6%206.6%202.5%2010.1%202.8l43.9%203.3c23.8%201.7%2059.3%2014%2083.2%2020.7Z%22%20fill%3D%22url(%23e)%22%2F%3E%0A%20%20%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M255%20200.5c-1.1%2024%201.9%2051.4%2018%2091.8l-5-.5c-14.5-42.1-17.7-63.7-16.6-88%201-24.3%208.9-43%2016.7-59%202-4%206.6-11.5%208.6-15.3%205.8-11.3%209.7-17.2%2013-27.5%204.8-14.4%203.8-21.2%203.2-28%203.7%2024.5-10.4%2045.8-21%2067.5a145%20145%200%200%200-17%2059Z%22%20fill%3D%22url(%23f)%22%2F%3E%0A%20%20%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M206%20285.1c2%204.4%203.7%208%204.9%2013.5l-4.3%201c-1.7-6.4-3-11-5.5-16.5-14.6-34.3-38-52-57-65%2023%2012.4%2046.7%2031.9%2061.9%2067Z%22%20fill%3D%22url(%23g)%22%2F%3E%0A%20%20%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M211.1%20303c8%2037.5-1%2085.2-27.5%20131.6%2022.2-46%2033-90.1%2024-131l3.5-.7Z%22%20fill%3D%22url(%23h)%22%2F%3E%0A%20%20%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M302.7%20299.5c43.5%2016.3%2060.3%2052%2072.8%2081.9-15.5-31.2-37-65.7-74.4-78.5-28.4-9.8-52.4-8.6-93.5.7l-.9-4c43.6-10%2066.4-11.2%2096%200Z%22%20fill%3D%22url(%23i)%22%2F%3E%0A%3C%2Fsvg%3E",
  id: "obsidian-stable",
  friendlyName: "Obsidian",
  twitter: "obsidian",
  async checkIsFixed() {
    const url = await fetch(
      "https://api.github.com/repos/obsidianmd/obsidian-releases/releases/latest"
    )
      .then((res) => res.json())
      .then(
        (data) =>
          data.assets.find((asset: { name: string }) =>
            asset.name.endsWith(".dmg")
          )?.browser_download_url
      );
    const pat = "_cornerMask";
    const result: { found: boolean; pos?: number } | null | undefined =
      await findPattern(url, pat);
    return result?.found ? FixedStatus.NOT_FIXED : FixedStatus.FIXED;
  },
};
